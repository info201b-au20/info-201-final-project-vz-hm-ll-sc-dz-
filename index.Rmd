---
title: "HFI Report"
output: html_document
---

```{r setup, include=FALSE}
source("scripts/chart_1_pf_identity.R")
source("scripts/chart_2_world.R")
```

## Introduction
Here, we look to investigate what factors shape human freedom across the world. The [Human Freedom Index](https://www.kaggle.com/gsutters/the-human-freedom-index) is a way to quantify human freedom based off of measures such as personal, civil, and economic freedom. The data operates under the assumption that human freedom is is defined as the absence of coercive constraint and is ranked on a scale from 1 (least freedom) to 10 (most freedom). Through all the protests and controversy, we want to see how these freedom indexes have changed over time, as well as what countries have been progressive enough for these indexes to increase.

The data comes from the Cato Institute, the Fraser Institute, and the Liberales Institut at the Friedrich Naumann Foundation for Freedom.

## Summary
The country with the highest human freedom idex (HFI) was ["New Zealand"] and the country with the lowest HFI was ["Syria"]. As for the average human freedom across different regions, North America ranks the highest, followed by Western Europe, East Asia, Oceania, 
Eastern Europe, Latin America & the Caribbean, Caucasus & Central Asia, South Asia, Sub-Saharan Africa, while Middle East & North Africa ranks the lowest. 

## Table 

## Visualizations

```{r chart1, echo=FALSE}
pf_identity_data <- hfi %>%
  select(year,
         countries,
         region,
         pf_identity,
         pf_identity_legal,
         pf_identity_sex,
         pf_identity_sex_female,
         pf_identity_sex_male,
         pf_identity_divorce)

pf_identity_summary_by_region <- pf_identity_data %>%
  filter(year == max(year)) %>%
  group_by(region) %>%
  summarize(pf_identity_legal_by_region =
              mean(as.numeric(pf_identity_legal), na.rm = T),
            pf_identity_sex_female_by_region =
              mean(as.numeric(pf_identity_sex_female), na.rm = T),
            pf_identity_sex_male_by_region =
              mean(as.numeric(pf_identity_sex_male), na.rm = T),
            pf_identity_identity_divorce_by_region =
              mean(as.numeric(pf_identity_divorce), na.rm = T),
            .groups = "drop")

region <- pf_identity_summary_by_region$region
pf_identity_legal <- pf_identity_summary_by_region$pf_identity_legal_by_region
pf_identity_sex_female <-
  pf_identity_summary_by_region$pf_identity_sex_female_by_region
pf_identity_sex_male <-
  pf_identity_summary_by_region$pf_identity_sex_male_by_region
pf_identity_divorce <-
  pf_identity_summary_by_region$pf_identity_identity_divorce_by_region
df <- data.frame(region,
                 pf_identity_legal,
                 pf_identity_sex_female,
                 pf_identity_sex_male,
                 pf_identity_divorce)
df_long <- gather(df, legend, mean_index, -region)

ggplot(data = df_long, aes(x = region, y = mean_index, fill = legend)) +
  geom_col(position = position_dodge()) +
  labs(title =
         "Personal Freedom: Identity and Relationships in 2017 (By Region)") +
  labs(x = "Region") +
  labs(y = "Mean Index") +
  labs(fill = "Legend")
```

_Explanations for Legend Labels:_ <br>
`pf_identity_divorce` measures whether women and men **1)** have the same legal
rights to initiate divorce and **2)** have the same requirements for divorce.
<br>
`pf_identity_legal` measures the degree to which people are free to legally
change their sex and gender.
<br>
`pf_identity_sex_female` measures the extent to which sexual relationships
between women are legal.
<br>
`pf_identity_sex_male` measures the extent to which sexual relationships
between men are legal.

This graph demonstrates the differences in personal freedoms across geographic regions. 


```{r chart2, echo=FALSE}
par(mai=c(0,0,0.2,0),xaxs="i",yaxs="i")
mapParams <- mapCountryData(joined, catMethod ='fixedWidth',  nameColumnToPlot="hf_score", missingCountryCol = 'grey', addLegend = FALSE, mapTitle='Freedom Index by Country - 2017')
map <- do.call( addMapLegend, c(mapParams, legendWidth=0.5, legendMar = 2))
```

This plot shows a geographical representation of the freedom index values across countries. Yellow indicates low freedom and red indicates a higher level of freedom. The grey represents countries without values. From the graphic, it is clear that countries that are generally considered more "developed" also have a higher level of human freedom. 

```{r chart3, echo=FALSE}
```
